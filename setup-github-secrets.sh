#!/bin/bash
# ?? ?????? ????? GitHub Secrets ????????

echo "?? ????? GitHub Secrets ??? Actions"
echo ""
echo "???????????????????????????????????????????????????????????????"
echo ""

# ?????? ?? ???? GitHub CLI
if ! command -v gh &> /dev/null; then
    echo "?? ????? GitHub CLI..."
    echo "????: https://cli.github.com/"
    exit 1
fi

# ?????? ?? ????? ??????
if ! gh auth status &> /dev/null; then
    echo "?? ????? ?????? ??? GitHub..."
    gh auth login
fi

echo ""
echo "?? ????? ??????? Vercel:"
echo ""

read -p "?? VERCEL_TOKEN: " VERCEL_TOKEN
read -p "?? VERCEL_ORG_ID: " VERCEL_ORG_ID
read -p "?? VERCEL_PROJECT_ID: " VERCEL_PROJECT_ID

if [ -z "$VERCEL_TOKEN" ] || [ -z "$VERCEL_ORG_ID" ] || [ -z "$VERCEL_PROJECT_ID" ]; then
    echo "? ??? ????? ???? ?????!"
    exit 1
fi

echo ""
echo "?? ????? Secrets ??? GitHub..."

gh secret set VERCEL_TOKEN --body "$VERCEL_TOKEN"
gh secret set VERCEL_ORG_ID --body "$VERCEL_ORG_ID"
gh secret set VERCEL_PROJECT_ID --body "$VERCEL_PROJECT_ID"

if [ $? -eq 0 ]; then
    echo ""
    echo "? ?? ????? ???? ??? Secrets ?????!"
    echo ""
    echo "?? ???? ????? ???????? ????!"
    echo "   ??? ?? git push ???? ????? ???????? ??? Vercel"
else
    echo ""
    echo "? ??? ???. ???? ??:"
    echo "   1. ?? ???? ??????? ?? ??? repository"
    echo "   2. ?? GitHub CLI ????? ??????"
fi
