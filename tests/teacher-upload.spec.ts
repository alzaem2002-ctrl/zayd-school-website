import { test, expect } from '@playwright/test';

const BASE = process.env.E2E_BASE_URL || 'http://localhost:4173'; // ???? ??? ??? ??????? ??????

test('????? ??? ??????? ????? ?????? ??? ??????', async ({ page }) => {
  await page.goto(BASE);
  // ???? ?? ??? ???? "???" ???? ???? ???????
  const firstUpload = page.getByRole('link', { name: '???' }).first();
  await expect(firstUpload).toBeVisible();
  const href = await firstUpload.getAttribute('href');
  expect(href).toContain('teacher-upload/');

  await firstUpload.click();
  await page.waitForLoadState('load');
  // ???? ????? ?? ????? ?? ????? ???? ?????? (???? ?? ??? ???? "?? ???????" ?? "????????" ???? ???)
  await expect(page.getByText('?? ???????').first()).not.toBeVisible({ timeout: 1000 }).catch(()=>{});
  await expect(page.getByText('????????').first()).not.toBeVisible({ timeout: 1000 }).catch(()=>{});

  // ????? ???? ????? (?????? ???)
  await page.setInputFiles('input[type="file"]', {
    name: 'report.docx',
    mimeType: 'application/vnd.openxmlformats-officedocument.wordprocessingml.document',
    buffer: Buffer.from('dummy')
  });
  await page.getByRole('button', { name: '??? ???????' }).click();
});
